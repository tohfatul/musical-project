<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music site</title>
    <link rel="stylesheet" href="/css/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/fontawesome/css/all.min.css">

    <script>

        window.onload = function () {

            let x = document.getElementById('showInvalid');
            x.style.display = 'none';
            document.getElementById('frmLogout').style.display='none';
            document.getElementById('frmLogin').style.display='block';

            document.getElementById('before-login').style.display='block';
            document.getElementById('after-login').style.display='none';

            sessionStorage.clear();

            document.getElementById('logout').onclick=function(){
                sessionStorage.clear();

                let xx = document.getElementById('showInvalid');
                xx.style.display = 'none';
                document.getElementById('frmLogout').style.display='none';
                document.getElementById('frmLogin').style.display='block';

                document.getElementById('txtUserName').value='';
                document.getElementById('txtPassword').value='';

                document.getElementById('before-login').style.display='block';
                document.getElementById('after-login').style.display='none';

            };

            document.getElementById('btnLogin').onclick = function () {
                sessionStorage.clear();
                let loginInfo = {
                    username: document.getElementById('txtUserName').value,
                    password: document.getElementById('txtPassword').value
                };
                fetch("http://localhost:3000/login", {
                    method: 'POST',
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(loginInfo)
                })
                    .then((res) => res.json())
                    .then((res) => {

                        //document.getElementById('username').innerHTML=res.username;
                        sessionStorage.setItem('username', res.username);
                        document.getElementById('welcomeuser').innerHTML= 'Welcome, ' + res.username;

                        if (sessionStorage.getItem('username') === 'not ok') {

                            x.style.display = 'block';

                            document.getElementById('frmLogout').style.display='none';
                            document.getElementById('frmLogin').style.display='block';

                            document.getElementById('before-login').style.display='block';
                            document.getElementById('after-login').style.display='none';

                        } else {
                            x.style.display = 'none';

                            document.getElementById('frmLogout').style.display='block';
                            document.getElementById('frmLogin').style.display='none';

                            document.getElementById('before-login').style.display='none';
                            document.getElementById('after-login').style.display='block';
                        }

                        
                       
                    });




            }


            // fetch("http://localhost:3000/users")
            //     .then((res) => res.json())
            //     .then((res) => {


            //         buildTable(res);
            //     });


        }

        // function buildTable(data) {
        //     var table = document.getElementById('myTable');
        //     for (let i = 0; i < data.length; i++) {
        //         let rw = `<tr>
        //                     <td>${data[i].username}</td>
        //                 </tr>`

        //         table.innerHTML += rw;
        //     }
        // }
    </script>
</head>

<body>

    <div class="container">
        <br>
        <!-- <p id="username">

        </p>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                </tr>
            </thead>

            <tbody id="myTable">

            </tbody>
        </table> -->
        <div class="row">

            <div class="col-sm-4">
                <img src="/img/circle-music.jpg" alt="" width="25%">
            </div>
            <div class="col-sm-8">
                <div id="frmLogin" name="frmLogin" class="float-right">
                    <div class="form-inline">
                        <label for="txtUserName">User Name</label>
                        <input type="text" id="txtUserName" name="username"
                            class="form-control form-control-sm ml-2 mr-2">

                        <label for="txtPassword">Password</label>
                        <input type="password" id="txtPassword" name="password"
                            class="form-control form-control-sm ml-2 mr-2">

                        <button class="btn btn-primary btn-sm" id="btnLogin">Login</button>

                    </div>
                    <br>
                    <span id="showInvalid" style="display: none;" class="text-danger float-right">Invalid username/ password</span>

                </div>

                <div id="frmLogout" class="float-right">
                    <div class="form-inline">
                        <input type="text" 
                        class="form-control form-control-sm mr-2"
                        placeholder="serach">
                        <button class="btn btn-default btn-sm mr-2">Search</button>
                        <label for="" id="welcomeuser">Welcome</label>
                        <button id="logout" class="btn btn-danger btn-sm ml-2">Logout</button>
                    </div>
                </div>


            </div>
        </div>
        <!-- //header row -->

        <div class="row">
            <div class="col-sm-12 text-center" id="before-login">
                <br>
                <h2>Welcome to Music website</h2>
            </div>

            <div class="col-sm-12 text-center" id="after-login">
                <h2>Song you may interest</h2>

                <br>
                <table class="table table-sm table-bordered">
                    <thead>
                        <tr>
                            <th width="10%">Id</th>
                            <th width="70%">Title</th>
                            <th width="10%">Release Date</th>
                            <th width="10%">Actions</th>

                        </tr>
                    </thead>

                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>See you again</td>
                            <td>2020-01-01</td>
                            <td>+</td>
                        </tr>

                        <tr>
                            <td>1</td>
                            <td>Baby baby</td>
                            <td>2019-01-01</td>
                            <td><i class="fa-solid fa-plus"></i></td>
                        </tr>
                    </tbody>
                </table>

                <br>

                <h2>Your playlist</h2>
                <p>No songs in your playlist</p>
                <table class="table table-sm table-bordered">
                    <thead>
                        <tr>
                            <th width="10%">Id</th>
                            <th width="70%">Title</th>
                            <th width="20%">actions</th>
                            
                        </tr>
                    </thead>

                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>See you again</td>
                           
                            <td><i class="fa-solid fa-minus mr-3"></i> <i class="fa-solid fa-play"></i></td>
                        </tr>

                        <tr>
                            <td>2</td>
                            <td>Baby baby</td>
                           
                            <td><i class="fa-solid fa-minus mr-3"></i> <i class="fa-solid fa-play"></i></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


</body>

</html>